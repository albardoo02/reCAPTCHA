<html lang="ja">
<head>
</head>
<body>
  <form id="rc_form" method="post" action="?">
    <div id="recaptcha"></div>
    <button id="send" type="submit">送信</button>
  </form>
<script>
  var onloadCallback = function() {
    grecaptcha.render('recaptcha', {
      'sitekey' : "6Ld1jb0fAAAAANrYQUwED3RKHxNzSM73Xdk5r560",
      'callback' : verifyCallback,
      'expired-callback' : expiredCallback
    });
  };
  var verifyCallback = function(response) { 
    document.getElementById('recaptcha').className = "verified";
    var recaptchaError = document.getElementById('recaptcha_error');
    if(recaptchaError != null) {
       recaptchaError.parentNode.removeChild(recaptchaError);
    } 
  };
  var expiredCallback = function() {
    document.getElementById('recaptcha').classList.remove('verified');
  };
</script> 
<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script> 
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> 
<script>
jQuery(function($){
  $("#rc_form").submit(function(){
    $("p.error").remove();
    if(!$('#recaptcha').hasClass('verified')) {
      $('#recaptcha').append("<p class='error' id='recaptcha_error'>チェックを入れてください</p>");
    }
    
    if($(".error").length > 0){
      //alert("Error");
      return false;
    }
  });
})
</script>
</body>
</html>
